-- 1.Which apps have the highest rating in the given available dataset
SELECT App,Rating
FROM `sigma-crow-312622.playstore.playstore_app`
GROUP BY APP,Rating
ORDER BY Rating DESC LIMIT 10;

-- 	2.What are the number of installs and reviews for the above apps? Return the apps with the highest reviews to the top.
SELECT App,Installs,Reviews,Rating
FROM `sigma-crow-312622.playstore.playstore_app`
GROUP BY APP,Reviews,Installs,Rating
ORDER BY Reviews DESC LIMIT 10;


-- 3.	Which app has the highest number of reviews? Also, mention the number of reviews and category of the app

  SELECT DISTINCT(App),Reviews,Category
  FROM `sigma-crow-312622.playstore.playstore_app`
  GROUP BY App,Reviews,Category
  ORDER BY Reviews DESC
  LIMIT 1;

--4.	What is the total amount of revenue generated by the google play store by hosting apps? (Whenever a user buys apps  from the google play store, the amount is considered in the revenue)

 SELECT SUM(Price) AS Revenue
 FROM `sigma-crow-312622.playstore.playstore_app`
 WHERE Type='Paid'
 GROUP BY TYPE;

--  5.	Which Category of google play store apps has the highest number of installs? also, find out the total number of installs for that particular category.

SELECT Category,max(Installs) AS Highest_installs,SUM(Installs) AS Total_installs
FROM `sigma-crow-312622.playstore.playstore_app`
GROUP BY Category
ORDER BY Highest_installs DESC ;



-- 6.	Which Genre has the most number of published apps?

SELECT DISTINCT(Genres),COUNT(App) AS more_pub_app
FROM `sigma-crow-312622.playstore.playstore_app`
GROUP BY Genres
ORDER BY more_pub_app DESC
LIMIT 1;


-- 7.	Provide the list of all games ordered in such a way that the game that has the highest number of installs is displayed on the top(to avoid duplicate results use distinct)

SELECT DISTINCT(App),Category,MAX(Installs) Max_installs
FROM `sigma-crow-312622.playstore.playstore_app`
WHERE Category IN(SELECT Category FROM `sigma-crow-312622.playstore.playstore_app` WHERE Category = 'GAME')
GROUP BY Category,App,Installs
ORDER BY Max_installs DESC;

-- 8.	Provide the list of apps that can work on android version 4.0.3 and UP.
SELECT DISTINCT(App) 
FROM `sigma-crow-312622.playstore.playstore_app`
WHERE Android_Ver = '4.0.3 and up';

-- 9.	How many apps from the given data set are free? Also, provide the number of paid apps.
SELECT Type,
  COUNT(CASE WHEN Type = 'Free' THEN 1 END )AS Free_count,
  COUNT(CASE WHEN TYPE = 'Paid' THEN 1 END) AS Paid_count
          
FROM `sigma-crow-312622.playstore.playstore_app`
GROUP BY Type;

-- 10.	Which is the best dating app? (Best dating app is the one having the highest number of Reviews)
SELECT App
FROM `sigma-crow-312622.playstore.playstore_app`
WHERE Category = 'DATING'
GROUP BY App
ORDER BY MAX(Reviews) DESC
LIMIT 1;

-- 11.	Get the number of reviews having positive sentiment and number of reviews having negative sentiment for the app 10 best foods for you and compare them.

SELECT 
  COUNT(CASE WHEN Sentiment = 'Positive' THEN 1 END) AS Positive_rev,
  COUNT(CASE WHEN Sentiment = 'Negative' THEN 1 END) AS Negative_rev
FROM `sigma-crow-312622.playstore.playstore_review`
WHERE `sigma-crow-312622.playstore.playstore_review`.App ='10 Best Foods for You'
GROUP BY Sentiment;

-- 12.	Which comments of ASUS SuperNote have sentiment polarity and sentiment subjectivity both as 1?

SELECT Translated_Review FROM `sigma-crow-312622.playstore.playstore_review`
WHERE `sigma-crow-312622.playstore.playstore_review`.App = 'ASUS SuperNote' AND
      `sigma-crow-312622.playstore.playstore_review`.Sentiment_Polarity = 1 AND
       `sigma-crow-312622.playstore.playstore_review`.Sentiment_Subjectivity =1;

-- 13.	Get all the neutral sentiment reviews for the app Abs Training-Burn belly fat 

SELECT Translated_Review FROM `sigma-crow-312622.playstore.playstore_review`
WHERE `sigma-crow-312622.playstore.playstore_review`.App = 'Abs Training-Burn belly fat' AND
      `sigma-crow-312622.playstore.playstore_review`.Sentiment = 'Neutral';

-- 14.	Extract all negative sentiment reviews for Adobe Acrobat Reader with their sentiment polarity and sentiment subjectivity
SELECT Translated_Review,Sentiment_Polarity,Sentiment_Subjectivity FROM `sigma-crow-312622.playstore.playstore_review`
WHERE `sigma-crow-312622.playstore.playstore_review`.App = 'Adobe Acrobat Reader' AND
      `sigma-crow-312622.playstore.playstore_review`.Sentiment ='Negative';





